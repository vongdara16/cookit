<%- include('../partials/html-head') %>
<link rel="stylesheet" href="/stylesheets/recipes/new.css">
<%- include('../partials/nav') %>

<main>
  <% if (user) { %>
    <h1><%= title %></h1>

    <form action="/recipes/<%= recipes[recipes.length-1]._id %>/ingredients" method="post">
      <label>
        Ingredients: 
        <input list="ingredientsList" name="ingredientsId" autocomplete="off" onclick="this.value=''">
        <datalist id="ingredientsList">
          <% ingredients.forEach(ingredient => { %> 
            <option value="<%= ingredient.name %>" data-value="<%= ingredient._id %>">
          <% }) %> 
        </datalist>
      </label>
      <button type="submit">Submit Ingredient</button>
    </form>

    <% const recentRecipe = recipes[recipes.length-1].ingredients %>
    
    <label>Current ingredients: 
      <ul>
        <% recentRecipe.forEach(ingredient => { %>
          <li><%= ingredient.name  %> </li>
          <% }) %> 
      </ul>
    </label>  

    <form action="/recipes/<%= recipes[recipes.length-1]._id %>?_method=PUT" method="post">
      <label>
        Instructions: 
        <textarea name="instructions" id="" cols="30" rows="10"></textarea>      
      </label>
      <button type="submit">Add Recipe</button>
    </form>
  <% } %>
</main>

<%- include('../partials/footer') %>
