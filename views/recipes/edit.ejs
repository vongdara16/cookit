<%- include('../partials/html-head') %>
<link rel="stylesheet" href="/stylesheets/recipes/edit.css">
<%- include('../partials/nav') %>

<main>
  <h3><%= title %> page</h1>
  <h1><%= recipe.name %></h1>
  <h4>By: <%= recipe.author.name %> </h4>
  <form action="/recipes/<%= recipe._id %>?_method=PUT" method="post">
    <button type="submit">Save Recipe</button><br>
    <label>Link: 
      <input type="text" name="link" value="<%= recipe.link  %>" >
    </label><br>
    <label>
      Type: 
      <select name="type">
        <option value="Appetizer">Appetizer</option>
        <option value="Entree">Entree</option>
        <option value="Dessert">Dessert</option>
      </select>
    </label>
    <!-- <label>Instructions: 
      <input type="text" name="instructions" value="<%= recipe.instructions %>" >
    </label> -->
  </form>
  
  <form action="/recipes/<%= recipe._id %>/ingredients/edit" method="post">
    <!-- <label>Ingredients: 
      <select name="ingredientsId">
        <%# ingredients.forEach(ingredient => { %> 
          <option value="<%#= ingredient._id %>"><%#= ingredient.name %></option>
        <%# }) %> 
      </select>
    </label> -->
    
    <label>
      Ingredients: 
      <input list="ingredientsList" name="ingredientsId" autocomplete="off" onclick="this.value=''">
      <datalist id="ingredientsList">
        <% ingredients.forEach(ingredient => { %> 
          <option value="<%= ingredient.name %>" data-value="<%= ingredient._id %>">
        <% }) %> 
      </datalist>
    </label>
    
    <button type="submit">Submit Ingredient</button>
    </form>

    <label>
      Current Ingredients: 
      <ul>
        <% recipe.ingredients.forEach(ingredient => {  %>
          <li><%= ingredient.name %></li>
          <form action="/recipes/<%= recipe._id %>/ingredients/<%= ingredient._id %>?_method=DELETE" method="post">
            <button type="submit">X</button>
          </form>
        <% }) %> 
      </ul>
    </label>
    <form action="/recipes/<%= recipe._id %>/instructions?_method=PATCH" method="post">
      <label>Instructions: 
        <textarea name="instructions" cols="30" rows="10"><%= recipe.instructions %></textarea>
        <!-- <input type="text" name="instructions" value="<%#= recipe.instructions %>" > -->
      </label>
      <button type="submit">Save Instructions</button>
    </form>
    
  </main>

<%- include('../partials/footer') %>
